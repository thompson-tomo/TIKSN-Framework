
namespace TIKSN.Security.Antimalware;

public static class AntimalwareScannerExtensions
{
    public static AntimalwareScanResult ScanFile(
        this IAntimalwareScanner antimalwareScanner,
        string path)
    {
        ArgumentNullException.ThrowIfNull(antimalwareScanner);

        if (string.IsNullOrEmpty(path))
        {
            throw new ArgumentException($"'{nameof(path)}' cannot be null or empty.", nameof(path));
        }

        var absolutePath = Path.GetFullPath(path);

        var fileContent = File.ReadAllBytes(absolutePath);

        return antimalwareScanner.ScanBinaryArray(fileContent, absolutePath);
    }
}
